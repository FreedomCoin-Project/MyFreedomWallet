<!DOCTYPE html>
<html lang='en'>

<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon">
  <!-- Primary Meta Tags -->
  <title>My Freedom Wallet</title>
  <meta name="title" content="My Freedom Wallet">
  <meta name="description"
    content="The wallet of the future - Receive, Send, Stake and Exchange using a completely decentralized, open-source, battle-hardened Freedom wallet.">
  <meta name="keywords"
    content="web,wallet,webwallet,crypto,cryptocurrency,opensource,oss,freed,staking,masternodes,exchange,swap,decentralized">
  <meta name="mobile-web-app-capable" content="yes">
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:locale" content="en_GB">
  <meta property="og:url" content="https://wallet.freedomcoin.global">
  <meta property="og:title" content="My Freed wallet">
  <meta property="og:description"
    content="The wallet of the future - Receive, Send, Stake and Exchange using a completely decentralized, open-source, battle-hardened Freed wallet.">
  <meta property="og:image" content="https://wallet.freedomcoin.global/assets/images/wallet_g.png">
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://twitter.com/FreedomcoinWW">
  <meta property="twitter:title" content="My Freed wallet">
  <meta property="twitter:description"
    content="The wallet of the future - Receive, Send, Stake and Exchange using a completely decentralized, open-source, battle-hardened Freedom wallet.">
  <meta property="twitter:image" content="https://wallet.freedomcoin.global/assets/images/wallet_g.png">
  <!-- Colour Theme -->
  <meta name="msapplication-TileColor" content="#470e75">
  <meta name="theme-color" content="#470e75">
  <link rel="icon" type="image/png" href="https://wallet.freedomcoin.global/assets/images/freed-op.png">
  <link rel="canonical" href="https://wallet.freedomcoin.global">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="assets/bootstrap-4.5.0/css/bootstrap.min.css">
  <link href="assets/fontawesome/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="assets/style/style.css">
  <script type="text/javascript" src="assets/bootstrap-4.5.0/js/jquery.js"></script>
  <script type="text/javascript" src="https://freedomcoin.global/js/instascan-builds/master"></script>
  <script type="text/javascript" src="https://freedomcoin.global/js/config/helpers.js"></script>
</head>

<body class="wlc">
  <div id="page-container" class="home-hero">
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark navbarSpecial">
      <div class="container">
        <a href="./" class="nav-logo">
          <img class="brand-logo" src="./assets/images/freed-op.png" loading="lazy" alt="FreedomCoin Logo">
          <span class="brand-txt noselect">MyFreedWallet</span>
        </a>
        <button id="navbarToggler" class="navbar-toggler collapsed show" type="button" aria-label="Toggle navigation">
          <span class="line"></span>
          <span class="line"></span>
          <span class="line"></span>
        </button>
        <div class="collapse navbar-collapse noselect" id="navbarNav">
          <div>
            <!-- MAIN NAVBAR & SIDE NAVBAR -->

            <div class="buttons-section">
              <a id='start' class="btn-border tablinks" onclick="openTab(event, 'keypair')" style="display: none">
                <img src="./assets/icons/home.svg" loading="eager" alt="Dashboard">
                <span>Dashboard</span>
              </a>
              <a id="stakeTab" class="btn-border tablinks" onclick="openTab(event, 'StakingTab')" style="display: none">
                <img src="./assets/icons/stake.svg" loading="eager" alt="Stake">
                <span>Stake</span>
              </a>
              <!--<a class="btn-border tablinks" style="display: none" onclick="$('#balance-box, #swap-box').toggle()">
                <img src="./assets/icons/swap.svg" loading="eager" alt="Swap">
                <span>Swap</span>
              </a>-->
              <a id='settingsTab' class="btn-border tablinks" onclick="openTab(event, 'Settings')"
                style="display: none">
                <img src="./assets/icons/setting.svg" loading="eager" alt="settings">
                <span>Settings</span>
              </a>
              <a class="btn-border tablinks">
                <img src="./assets/icons/game.svg" loading="eager" alt="Games">
                <span>Games</span>
              </a>
              <a class="btn-border tablinks">
                <img src="./assets/icons/store.svg" loading="eager" alt="Store">
                <span>Store</span>
              </a>
              <a id="Network" class="btn-border tablinks" onclick="toggleNetwork()" style="display: none">
                <img src="./assets/icons/wifi.svg" loading="eager" alt="Network">
                <img src="./assets/icons/no-wifi.svg" loading="eager" alt="Network" style="display: none">
                <span></span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <!-- // NAVBAR -->
    <div id="content-wrap">

      <!-- // WARNING MESSAGE -->
      <div class="warning-message" id='outdated'>
        <div class="container">
          <p>WARNING: your version is outdated, please update to the newest stable version at the <a
              href='https://github.com/FreedomCoin-Project/MyFreedomWallet'>MyFreedWallet Github</a></p>
        </div>
      </div>
      <!-- // WARNING MESSAGE -->


      <!-- // QR MODAL -->
      <div class="modal" id="qrModal">
        <div class="modal-dialog" role="document" style="display:none">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="qrModalLabel">Address QR</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body center-text">
              <p id="ModalQRLabel" class="modal-label"></p>
              <div id="ModalQR" class="auto-fit"></div>
            </div>
          </div>
        </div>
        <div id="address-box" class="large-box">
          <button type="button" id="dismiss-modal" class="close" onclick="openModal(event, 'address-box')">
            <span aria-hidden="true">×</span>
          </button>
          <div id="title-address-box">
            <h3 class="noselect addr-title">
              <span>Your</span> FREED <span>Address</span>
            </h3>
          </div>
          <div id="box-info-address">
            <div id="pubkey-padd">
              <div id="PublicQR" class="margin-padded-qr" style="display: block;"><img src="" width="82" height="82">
              </div>
            </div>
            <div id="address-info">
              <b id="guiAddress">~</b>
              <b id="guiQRButton">
                <!-- <i data-toggle="modal" data-target="#qrModal" class="fas fa-qrcode fa-stacked-ptr"></i>-->
                <i onclick="toClipboard('guiAddress', this)" id="guiAddressCopy"
                  class="fas fa-clipboard fa-stacked-ptr"></i>
              </b>
            </div>
          </div>

        </div>
        <div id="Transaction" class="tabcontent">
          <button type="button" id="dismiss-modal" class="close" onclick="openModal(event, 'Transaction', 'T')">
            <span aria-hidden="true">×</span>
          </button>
          <!-- PIVX TITLE SECTION -->
          <div class="col-md-12 title-section float-left rm-pd">
            <h3 class="pivx-bold-title center-text"><span id="simpleTransactionsTitle">Create a</span> Transaction</h3>
          </div>
          <br>
          <!-- // PIVX TITLE SECTION -->

          <div id='sendNotice' class="col-md-12 float-left">
            <span id='blocks'></span>
            <div id='notice'></div>
          </div>
          <div class="col-md-12">
            <p id="communication" class="center-text">Please <b>AVOID</b> sending to Shielded addresses using this
              wallet - this functionality is currently unsupported.</p>
          </div>
          <div class='max-width' style='clear:both;'>
            <!--<div id="simpleTransactionsDropdown" class="bold-trans" onclick='toggleDropDown("simpleTransactions")'>
              Send Freedom Coin<span style='float:right;'>▼</span></div>-->
            <div id='simpleTransactions' style='display: block'>
              <div id="addr-reader" class="my-qr-reader" style="display: none;"></div>
              <br>
              <label>Recipient Wallet Address</label><br>
              <div class="scan-qr">
                <input type="text" id="address1s" style="width: 100%;font-family: monospace;" class="center-text">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 122.61 122.88">
                  <title>Scan QR Code</title>
                  <path
                    d="M23.38,0h13V11.15h-13a12.22,12.22,0,0,0-8.64,3.57l0,0a12.22,12.22,0,0,0-3.57,8.64V39.32H0V23.38A23.32,23.32,0,0,1,6.86,6.89l0,0A23.31,23.31,0,0,1,23.38,0ZM3.25,54.91H119.36a3.29,3.29,0,0,1,3.25,3.27V64.7A3.29,3.29,0,0,1,119.36,68H3.25A3.28,3.28,0,0,1,0,64.7V58.18a3.27,3.27,0,0,1,3.25-3.27ZM90.57,0h8.66a23.28,23.28,0,0,1,16.49,6.86v0a23.32,23.32,0,0,1,6.87,16.52V39.32H111.46V23.38a12.2,12.2,0,0,0-3.6-8.63v0a12.21,12.21,0,0,0-8.64-3.58H90.57V0Zm32,81.85V99.5a23.46,23.46,0,0,1-23.38,23.38H90.57V111.73h8.66A12.29,12.29,0,0,0,111.46,99.5V81.85Zm-86.23,41h-13A23.32,23.32,0,0,1,6.86,116l-.32-.35A23.28,23.28,0,0,1,0,99.5V81.85H11.15V99.5a12.25,12.25,0,0,0,3.35,8.41l.25.22a12.2,12.2,0,0,0,8.63,3.6h13v11.15Z">
                  </path>
                </svg>
              </div>
              <br>
              <label>Amount</label>
              <br>
              <input class="center-text" type="text" id="value1s" maxlength="9"
                oninput="this.value = formatNumber(this.value, true)" onblur="addZeroIfDotEnd(this)">
              <span id='toburn' style='font-size:13px;color:red;'></span><br>
              <span id='total_val' style='font-size:13px;color:gray;'></span>
              <div id="reqDescDisplay" style="display: none;">
                <label>Description (from the merchant)</label><br>
                <input class="center-text" type="text" disabled id="reqDesc">
              </div>
              <br>
              <div id='HumanReadable'></div>
              <br>
              <button class="pivx-button-big btn-border send_tx" onclick="createTxGUI()">
                <span class="buttoni-icon"><i class="fas fa-paper-plane fa-tiny-margin"></i></span>
                <span class="buttoni-text btn_txt" id="genIt">Send Transaction</span>
                <span class="buttoni-arrow btn_txt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                    <path
                      d="M23.328 16.707L13.121 26.914a.5.5 0 01-.707 0l-2.828-2.828a.5.5 0 010-.707L16.964 16 9.586 8.621a.5.5 0 010-.707l2.828-2.828a.5.5 0 01.707 0l10.207 10.207a1 1 0 010 1.414z">
                    </path>
                  </svg></span>
              </button>
              <button class="pivx-button-big btn-border sync_bl" style="display:none;text-transform:capitalize;"
                disabled>
                <span class="buttoni-icon"><i class="fas fa-sync fa-spin fa-tiny-margin"></i></span>
                <span class="buttoni-text btn_txt">Synchronizing</span>
              </button>
            </div>
            <div id='transactionFinal'></div>
          </div>
          <br>
          <div id='CreateManualTransactions' class='max-width' style='clear:both;'>
            <div onclick='toggleDropDown("advTransactions")' class="bold-trans">Create Manual Transactions<span
                style='float:right;'>▼</span></div>
            <div id='advTransactions' style='display:none'>
              <br>
              <h3>Inputs</h3>
              <label>Trx Hash</label><br>
              <input type="text" id="prevTrxHash">
              <label>Index</label><br>
              <input type="text" id="index">
              <label>Script</label><br>
              <input type="text" id="script"><br><br>
              <h3>Outputs</h3>
              <label>Output Address 1</label><br>
              <input type="text" id="address1">
              <label>Amount</label><br>
              <input type="text" id="value1">
              <br />
              <label>Output address 2</label><br>
              <input type="text" id="address2">
              <label>Amount</label><br>
              <input type="text" id="value2"><br><br>
              <h3>WIF Key</h3>
              <label>key</label><br>
              <input type="text" id="wif">
              <br /><br />
              <p style="padding: 5px 0 15px;"><b>WARNING:</b> ANY FUNDS NOT ALLOCATED WILL BE USED AS FEES</p>
              <button class="pivx-button-big btn-border" onclick="createRawTransaction()">
                <span class="buttoni-icon"><i class="fas fa-paper-plane fa-tiny-margin"></i></span>
                <span class="buttoni-text btn_txt">Create Raw Signed Transction</span>
                <span class="buttoni-arrow btn_txt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                    <path
                      d="M23.328 16.707L13.121 26.914a.5.5 0 01-.707 0l-2.828-2.828a.5.5 0 010-.707L16.964 16 9.586 8.621a.5.5 0 010-.707l2.828-2.828a.5.5 0 01.707 0l10.207 10.207a1 1 0 010 1.414z">
                    </path>
                  </svg></span>
              </button>
              <br /><br /><br />
              <h4 id="signed-raw">Signed Raw Transaction</h4>
              <textarea rows="15" cols="70" id="rawTrx"></textarea>
              <p>Don't understand how this works? <a target='_blank'
                  href='https://github.com/FreedomCoin-Project/MyFreedomWallet'>Tutorial Here</a></p>
              <p>Advanced Details: <br>locktime is set to 0, sequence is set to max. SIGHASH_ALL option is chosen
                for signing raw Transaction.</p>
            </div>
          </div>
        </div>

      </div>
      <br>
      <!-- // QR MODAL -->

      <div class="container">
        <div class="row no-gutters">
          <div class='col-md-12 rm-pd'>

            <!-- KEYPAIR SECTION -->
            <div id="keypair" class="tabcontent">

              <!-- ACCESS WALLET -->
              <div id="accessWallet" class="dashboard-item">
                <div class="container">

                  <div class="col-md-12 dashboard-title">
                    <h3 class="pivx-bold-title-smaller">My Wallet</h3>
                    <p>This will import a Freedom wallet that you hold via it's private key, loading the address and
                      pulling your existing wallet balance from the patriot node network.
                      <br>
                      <span style="opacity: 0.75; font-size: small;">Warning : This (MFW) web wallet is run as a single
                        page application and there is no record of your private key. <u>Private key can not be
                          recovered.</u></span>
                    </p>
                  </div>

                  <!-- IMPORT WALLET -->
                  <div id="prv-reader" class="my-qr-reader" style="display: none;"></div>
                  <input class="hide-element" type="text" id="clipboard">
                  <div id='importWallet' style='display: none;'>
                    <div class="scan-qr">
                      <input type="password" id='privateKey' placeholder="Private Key">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 122.61 122.88">
                        <title>Scan QR Code</title>
                        <path
                          d="M23.38,0h13V11.15h-13a12.22,12.22,0,0,0-8.64,3.57l0,0a12.22,12.22,0,0,0-3.57,8.64V39.32H0V23.38A23.32,23.32,0,0,1,6.86,6.89l0,0A23.31,23.31,0,0,1,23.38,0ZM3.25,54.91H119.36a3.29,3.29,0,0,1,3.25,3.27V64.7A3.29,3.29,0,0,1,119.36,68H3.25A3.28,3.28,0,0,1,0,64.7V58.18a3.27,3.27,0,0,1,3.25-3.27ZM90.57,0h8.66a23.28,23.28,0,0,1,16.49,6.86v0a23.32,23.32,0,0,1,6.87,16.52V39.32H111.46V23.38a12.2,12.2,0,0,0-3.6-8.63v0a12.21,12.21,0,0,0-8.64-3.58H90.57V0Zm32,81.85V99.5a23.46,23.46,0,0,1-23.38,23.38H90.57V111.73h8.66A12.29,12.29,0,0,0,111.46,99.5V81.85Zm-86.23,41h-13A23.32,23.32,0,0,1,6.86,116l-.32-.35A23.28,23.28,0,0,1,0,99.5V81.85H11.15V99.5a12.25,12.25,0,0,0,3.35,8.41l.25.22a12.2,12.2,0,0,0,8.63,3.6h13v11.15Z">
                        </path>
                      </svg>
                    </div>
                    <button class="pivx-button-big btn-border" onclick="guiImportWallet()">
                      <span class="buttoni-icon"><i class="fas fa-file-upload fa-tiny-margin"></i></span>
                      <span class="buttoni-text btn_txt" id="importWalletText">Import Wallet</span>
                    </button>
                  </div>
                  <!-- // IMPORT WALLET -->

                  <button class="pivx-button-big btn-border" id="accessWalletBtn" onclick="accessOrImportWallet()">
                    <span class="buttoni-text btn_txt" id='wToggle'>Access My Wallet</span>
                  </button>
                </div>
              </div>
              <!-- // ACESSS WALLET -->

              <!-- WALLET FUNCTIONALITIES -->

              <!-- WARNING -->
              <div id='genKeyWarning' style='display: none;' class="alert alert-danger col-md-12" role="alert">
                <button type="button" class="close hide-modal" onclick="hideModal(event, 'genKeyWarning', 'hide')">
                  <svg fill="#fff" height=" 23" width=" 23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                    <path
                      d="M23.328 16.707L13.121 26.914a.5.5 0 01-.707 0l-2.828-2.828a.5.5 0 010-.707L16.964 16 9.586 8.621a.5.5 0 010-.707l2.828-2.828a.5.5 0 01.707 0l10.207 10.207a1 1 0 010 1.414z">
                    </path>
                  </svg>
                </button>
                <div style="max-width: 100% !important;">
                  <p id="encryptWarningText" class="center-text">
                    <b>WARNING</b><br>
                    If you don't save your private key you will lose access to your funds!<br>
                    Would you like to encrypt & save your wallet in your browser?
                  </p>
                </div>
                <div id="encryptPassword"
                  style="display: none; max-width: 100% !important; max-width: 100% !important;">
                  <span style="color:var(--warning);">Note: Your key will be lost if you clear your browser cookies.
                    Make sure to
                    copy and store your private key in a safe place to secure your wallet.</span>
                  <input class="center-text" style="width: 100%; margin-top: 10px; font-family: monospace;"
                    type="password" id="newPassword" placeholder="Enter Password">
                  <input class="center-text" style="width: 100%; font-family: monospace;" type="password"
                    id="newPasswordRetype" placeholder="Re-type Password">
                </div>

                <div id="pubkey-box" class="desktop-pubkey">
                  <div id="PrivateQR" class="margin-padded-qr" style="display: none;"><img src="" width="82"
                      height="82">
                  </div>
                  <textarea id="PrivateTxt" style="display: none;" disabled=""
                    class="form-control private-key-area"></textarea>
                  <div class="pivx-button-big" onclick="toggleKeyView()">
                    <span class="buttoni-icon"><i class="far fa-eye fa-tiny-margin"></i></span>
                    <span class="buttoni-text btn_txt" id="guiViewKey">Show Private key</span>
                  </div>
                </div>

                <button class="pivx-button-big btn-border" onclick="guiEncryptWallet()"
                  style="float: none;margin: 0 auto;display: block;">
                  <span class="buttoni-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                      <path
                        d="M85.967 10.65l-32.15-9.481a13.466 13.466 0 00-7.632 0l-32.15 9.48C11.661 11.351 10 13.567 10 16.042v26.623c0 12.321 3.67 24.186 10.609 34.31 6.774 9.885 16.204 17.49 27.264 21.99a5.612 5.612 0 004.251 0c11.061-4.5 20.491-12.104 27.266-21.99C86.329 66.85 90 54.985 90 42.664V16.042a5.656 5.656 0 00-4.033-5.392zM69 68.522C69 70.907 67.03 72 64.584 72H34.092C31.646 72 30 70.907 30 68.522v-23.49C30 42.647 31.646 41 34.092 41H37v-9.828C37 24.524 41.354 18.5 49.406 18.5 57.37 18.5 62 24.066 62 31.172V41h2.584C67.03 41 69 42.647 69 45.032v23.49zM58 41v-9.828c0-4.671-3.708-8.472-8.5-8.472-4.791 0-8.5 3.8-8.5 8.472V41h17z">
                      </path>
                    </svg></span>
                  <span class="buttoni-text btn_txt" id="encryptButton">Set Password</span>
                  <span class="buttoni-arrow btn_txt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                      <path
                        d="M23.328 16.707L13.121 26.914a.5.5 0 01-.707 0l-2.828-2.828a.5.5 0 010-.707L16.964 16 9.586 8.621a.5.5 0 010-.707l2.828-2.828a.5.5 0 01.707 0l10.207 10.207a1 1 0 010 1.414z">
                      </path>
                    </svg></span>
                </button>
              </div>
              <!-- // WARNING -->
              <br>

              <!-- WALLET FEATURES -->
              <div id="guiWallet" style="display: none;">
                <div id="bcg-wallet-box">
                  <div id="headline-balance">
                    <div id="balance-box" class="large-box loading">
                      <div id="bal-wrapper">
                        <div id="piv-ring"></div>
                        <div id="bal-title">
                          <div class="noselect balance-title">
                            <span class="bal-text">Current Balance</span>
                          </div>
                        </div>
                        <div id="number-piv">
                          <p id="guiBalanceBox"><b id="guiBalance">~</b> <span style=" font-size: 15px; ">FREED</span>
                          </p>
                        </div>
                        <span id="bal-usd"></span>
                        <div class="balance-transaction">
                          <div class="dep-text" onclick="openModal(event, 'address-box')">
                            <img src="./assets/images/icons/deposit.svg" alt="Deposit">
                            <span>Receive</span>
                          </div>
                          <div id="txTab" class="send-text" onclick="openModal(event, 'Transaction')">
                            <img src="./assets/images/icons/send.svg" alt="Send">
                            <span>Send</span>
                          </div>
                        </div>
                      </div>
                      <div id="coin-icon">
                        <img src="./assets/images/freed.png" alt="FreedomCoin Logo">
                      </div>
                    </div>
                    <div id="swap-box" class="large-box">
                      <div class="swap-header">
                        <h2>Swap</h2>
                      </div>
                      <div class="swap-body">
                        <div class="swap-section">

                          <div class="input-group">
                            <input type="text" id="swap-from" maxlength="9"
                              oninput="this.value = formatNumber(this.value)" onblur="addZeroIfDotEnd(this)">
                            <select id="from-coin">
                              <option value="FREED">FREED</option>
                            </select>
                          </div>
                        </div>
                        <div class="swap-section">

                          <div class="input-group">
                            <input type="text" id="swap-to" disabled="">
                            <select id="to-coin">
                              <option value="FREED">LTC</option>
                              <option value="BTC">BTC</option>
                              <option value="ETH">XRP</option>
                            </select>
                          </div>
                        </div>
                        <button id="swap-button" class="btn-border pivx-button-big" onclick="swap()">Swap</button>
                      </div>
                    </div>
                  </div>
                  <!-- WALLET FEATURE -->
                  <div id="big-frame-address">

                    <div id="transaction_table">
                      <h6 style=" font-weight: 100; padding: 20px 5px;">Recent Transactions</h6>
                      <div id="transactionTableBody" class="large-box loading">
                        <span>Loading transactions...</span>
                      </div>
                      <div id="more_transaction"></div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- WALLET FEATURES -->

              <!-- // WALLET FUNCTIONALITIES -->

              <!-- GENERATE VANITY WALLET -->
              <div id='generateVanityWallet' class="dashboard-item">
                <div class="container">

                  <div class="col-md-12 dashboard-title">
                    <h3 class="pivx-bold-title" style="font-size:28px;">Vanity Wallet</h3>
                    <span class="badge badge-warning">Experimental</span>
                    <p>This will create a new FreedomCoin wallet with a customized prefix that you choose, Enter a few
                      characters after the initial letter "T" and we will find a custom wallet address for you if
                      available.</p>
                  </div>


                  <input style="display:none;" type="text" id='prefix' placeholder="Address Prefix"
                    onkeyup="checkVanity()">

                  <button class="pivx-button-big btn-border" onclick="generateVanityWallet()">
                    <span class="buttoni-text btn_txt" id="vanButtonText">Create A Vanity Wallet</span>
                  </button>
                </div>
              </div>
              <!-- // GENERATE VANITY WALLET -->
              <br>

              <!-- GENERATE WALLET -->
              <div id='generateWallet' class="dashboard-item">
                <div class="container">


                  <div class="col-md-12 dashboard-title">
                    <h3 class="pivx-bold-title-smaller">New Wallet</h3>
                    <p>This will create a new, random Freedom wallet that will contain no initial funds, you may
                      transfer to-and-from this wallet with ease.</p>
                  </div>


                  <button class="pivx-button-big btn-border" onclick="generateWallet()">
                    <span class="buttoni-text btn_txt">Create A New Wallet</span>
                  </button>
                </div>
              </div>
              <!-- // GENERATE WALLET -->
              <br>


              <br>

            </div>
            <!-- // KEYPAIR SECTION -->

            <div id="StakingTab" class="tabcontent">
              <!-- STAKING FEATURES -->
              <p id="info" class="minor-notif-subtext"><b>New Feature!</b><br>Please be aware MPW Cold Staking is a new,
                slightly experimental feature, it may be unstable, and is currently slow. Please have patience when
                using this feature, and wait for block confirmations before actions and balances are shown on-screen.
              </p>
              <div class="add-frame">
                <div class="staking-banner-top">
                  <div id="staking-rectangle" class="col-md-4">
                    <div id="pivx-price-box">
                      <div id="icon-box-piv">
                        <div id="piv-price" class="staking-piv-icon"></div>
                      </div>
                      <div id="piv-price-amount">
                        <p id="guiBalanceBoxStaking"><b id="guiBalanceStaking">~</b> FREED</p>
                      </div>
                    </div>
                    <div id="staking-box">
                      <h3 id="stake-title" class="noselect">Staking &nbsp;&nbsp;<span id="balanceReloadStaking"
                          class="reload noselect" onclick="refreshChainData()">&#x21bb;</span></h3>
                    </div>
                  </div>
                </div>
                <br>
                <div class="staking-banner-bottom">
                  <div class="stake-box large-box col-md-4">
                    <h5 id="availToDelegate" class="stake-balances">Available: 0 FREED</h5>
                    <textarea id="delegateAmount" class="stake-input form-control private-key-area"></textarea>
                    <div class="button-padd">
                      <button class="pivx-button-big btn-border" onclick="delegateGUI()">
                        <span class="buttoni-text btn_txt">Delegate</span>
                        <span class="buttoni-arrow btn_txt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                            <path
                              d="M23.328 16.707L13.121 26.914a.5.5 0 01-.707 0l-2.828-2.828a.5.5 0 010-.707L16.964 16 9.586 8.621a.5.5 0 010-.707l2.828-2.828a.5.5 0 01.707 0l10.207 10.207a1 1 0 010 1.414z">
                            </path>
                          </svg></span>
                      </button>
                    </div>
                  </div>
                  <div class="stake-box large-box col-md-4">
                    <h5 id="availToUndelegate" class="stake-balances">Staking: 0 FREED</h5>
                    <textarea id="undelegateAmount" class="stake-input form-control private-key-area"></textarea>
                    <div class="button-padd">
                      <button class="pivx-button-big btn-border" onclick="undelegateGUI()">
                        <span class="buttoni-text btn_txt">Undelegate</span>
                        <span class="buttoni-arrow btn_txt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                            <path
                              d="M23.328 16.707L13.121 26.914a.5.5 0 01-.707 0l-2.828-2.828a.5.5 0 010-.707L16.964 16 9.586 8.621a.5.5 0 010-.707l2.828-2.828a.5.5 0 01.707 0l10.207 10.207a1 1 0 010 1.414z">
                            </path>
                          </svg></span>
                      </button>
                    </div>
                  </div>
                </div>
                <!-- STAKING FEATURES -->
              </div>
            </div>




            <div id="Settings" class="tabcontent">
              <div class="explorer-type">
                <label for="explorer">Choose an explorer:</label>
                <br>
                <select id="explorer" class="form-control" name="explorer">
                  <!-- Populated via JS at DOM load (settings.js) -->
                </select>
                <br>
                <button class="pivx-button-big btn-border" onclick="toggleNetwork()">
                  <span class="buttoni-icon"><i class="fas fa-network-wired fa-tiny-margin"></i></span>
                  <span class="buttoni-text btn_txt">Toggle Networking Mode</span>
                  <span class="buttoni-arrow btn_txt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                      <path
                        d="M23.328 16.707L13.121 26.914a.5.5 0 01-.707 0l-2.828-2.828a.5.5 0 010-.707L16.964 16 9.586 8.621a.5.5 0 010-.707l2.828-2.828a.5.5 0 01.707 0l10.207 10.207a1 1 0 010 1.414z">
                      </path>
                    </svg>
                  </span>
                </button>
              </div>
              <button id="Debug" class="pivx-button-big btn-border" onclick="toggleDebug()" style="display: none;">
                <span class="buttoni-icon"><i class="fas fa-bug fa-tiny-margin"></i></span>
                <span class="buttoni-text btn_txt">Toggle Debug Mode</span>
                <span class="buttoni-arrow btn_txt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
                    <path
                      d="M23.328 16.707L13.121 26.914a.5.5 0 01-.707 0l-2.828-2.828a.5.5 0 010-.707L16.964 16 9.586 8.621a.5.5 0 010-.707l2.828-2.828a.5.5 0 01.707 0l10.207 10.207a1 1 0 010 1.414z">
                    </path>
                  </svg></span>
              </button>

              <div class="priv-key">
                <div id="keyQR" class="margin-padded-qr" style="display: none;">
                  <img src="" width="82" height="82">
                </div>
                <textarea id="keyTxt" style="display: none;" disabled=""
                  class="form-control private-key-area"></textarea>
                <div class="pivx-button-big btn-border" onclick="toggleKey()">
                  <span class="buttoni-icon"><i class="far fa-eye fa-tiny-margin"></i></span>
                  <span class="buttoni-text btn_txt" id="guiPrivKey">Show Private key</span>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>

      <footer id="foot">
        <div class="footer">
          <div id='dcfooter'>© MIT 2022 - <b style='cursor:pointer' onclick='openDonatePage()'>Donate to
              FreedomCoin!</b>
          </div>
        </div>
      </footer>
    </div>
    <!--
      Alert
    -->
    <div class="alertPositioning"></div>

    <!-- Freed Welcome Section -->
    <div class="welcome-wrapper container">
      <div class="welcome-section">
        <div class="text-section">
          <h1>Your Keys, Your Freed</h1>
          <h5>
            <span>Experience a non-custodial wallet that provides a full suite of services, allowing you to buy, sell,
              trade, and stake FreedomCoin—all within a safe and simple app.</span>
          </h5>
        </div>
        <div class="buttons-section">
          <a id="open" class="btn-border"><span class="btn_txt">Get Started</span></a>
          <a class="btn-border" href="https://freedomcoin.global/wallets/freedomcore" target="_blank">
            <span class="btn_txt">Download PC Wallet</span>
            <svg style="width: 15px;height: auto;fill: #fffeff;margin: 4px 0 4px 10px;"
              xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
              <path
                d="M23.328 16.707L13.121 26.914a.5.5 0 01-.707 0l-2.828-2.828a.5.5 0 010-.707L16.964 16 9.586 8.621a.5.5 0 010-.707l2.828-2.828a.5.5 0 01.707 0l10.207 10.207a1 1 0 010 1.414z">
              </path>
            </svg>
          </a>
        </div>
      </div>
      <div class="image-section"></div>
    </div>
  </div>

  <!-- Load frontend-level components -->
  <script type="text/javascript" src="scripts/settings.js"></script>
  <script type="text/javascript" src="scripts/misc.js"></script>
  <script type="text/javascript" src="scripts/wallet.js"></script>
  <script type="text/javascript" src="scripts/network.js"></script>

  <script>
    // WALLET STATE DATA
    let cachedUTXOs = [];
    let cachedBlockCount = 0;

    // Cached DOM elements
    const domStart = document.getElementById("start");
    const domSettings = document.getElementById("settingsTab");
    const domNavbarToggler = document.getElementById("navbarToggler");
    const domGuiWallet = document.getElementById('guiWallet');
    const domGuiBalance = document.getElementById("guiBalance");
    const domGuiBalanceBox = document.getElementById("guiBalanceBox");
    const domTxTab = document.getElementById("txTab");
    const domsendNotice = document.getElementById("notice");
    const domSimpleTXsTitleSpan = document.getElementById("simpleTransactionsTitle");
    const domSimpleTXs = document.getElementById("simpleTransactions");
    const domSimpleTXsDropdown = document.getElementById("simpleTransactionsDropdown");
    const domAddress1s = document.getElementById("address1s");
    const domValue1s = document.getElementById("value1s");
    const domGuiViewKey = document.getElementById('guiViewKey');
    const domPrivateTxt = document.getElementById('PrivateTxt');
    const domPrivateQr = document.getElementById('PrivateQR');
    const domPublicQr = document.getElementById('PublicQR');
    const domModalQR = document.getElementById('ModalQR');
    const domModalQrLabel = document.getElementById('ModalQRLabel');
    const domPrefix = document.getElementById('prefix');
    const domWalletToggle = document.getElementById("wToggle");
    const domGenerateWallet = document.getElementById('generateWallet');
    const domGenVanityWallet = document.getElementById('generateVanityWallet');
    const domAccessWallet = document.getElementById('accessWallet');
    const domImportWallet = document.getElementById('importWallet');
    const domImportWalletText = document.getElementById('importWalletText');
    const domAccessWalletBtn = document.getElementById('accessWalletBtn');
    const domVanityUiButtonTxt = document.getElementById("vanButtonText");
    const domGenKeyWarning = document.getElementById('genKeyWarning');
    const domEncryptWarningTxt = document.getElementById('encryptWarningText');
    const domEncryptBtnTxt = document.getElementById('encryptButton');
    const domEncryptPasswordBox = document.getElementById('encryptPassword');
    const domEncryptPasswordFirst = document.getElementById('newPassword');
    const domEncryptPasswordSecond = document.getElementById('newPasswordRetype');
    const domGuiAddress = document.getElementById('guiAddress');
    const domGenIt = document.getElementById("genIt");
    const domHumanReadable = document.getElementById("HumanReadable");
    const domTxOutput = document.getElementById("transactionFinal");
    const domReqDesc = document.getElementById('reqDesc');
    const domReqDisplay = document.getElementById('reqDescDisplay');
    const domIdenticon = document.getElementById("identicon");
    const domPrivKey = document.getElementById("privateKey");

    // Aggregate menu screens and links for faster switching
    const arrDomScreens = document.getElementsByClassName("tabcontent");
    const arrDomScreenLinks = document.getElementsByClassName("tablinks");

    // Alert DOM element
    const domAlertPos = document.getElementsByClassName("alertPositioning")[0];

    function getBalance(updateGUI = false) {
      const nBalance = cachedUTXOs.reduce((sum, utxo) => sum + utxo.sats, 0);
      guiBal = nBalance / COIN;
      // Update the GUI only when all UTXOs are processed
      if (updateGUI && arrUTXOsToValidate.length === 0) {
        const formattedBalance = (nBalance / COIN).toFixed((nBalance / COIN).toFixed(2).length >= 6 ? 0 : 2);
        domGuiBalance.innerText = formattedBalance;
        price_tick(Number(formattedBalance));

        domsendNotice.innerHTML = nBalance ? '' :
          `<div class="alert alert-danger" role="alert">
                  <h4>Note:</h4>
                  <h5>You don't have any funds, get some coins first!</h5>
              </div>`;
      }

      return nBalance;
    }

    let price;
    function price_update() {
      $.getJSON("https://freedomcoin.global/pack/fetch-freed-price/", data => price = Number(data.last_price).toFixed(5));
    }
    setInterval(price_update, 160000);
    price_update();

    function price_tick(amount) {
      balusd = (Number(price) * amount).toFixed(3);
      $("#bal-usd").html("$ " + balusd);
    }


    // URL-Query request processing
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    let requestTo;
    let requestAmount;
    // Check for a payment request
    if (urlParams.has('pay') && urlParams.has('amount')) {
      requestTo = urlParams.get('pay');
      requestAmount = parseFloat(urlParams.get('amount'));
      console.log(requestTo + " " + requestAmount);
      // We have our payment request info, wait until the page is fully loaded then display the payment request via .onload
    }

    $("#open").click(function () {
      $(".welcome-wrapper").fadeOut("slow", function () {
        $("body").removeClass();
      });
    });

    function toClipboard(source, caller) {
      // Fetch the text/value source
      const domCopy = document.getElementById(source);

      // Use an invisible textbox as the clipboard source
      const domClipboard = document.getElementById('clipboard');
      domClipboard.value = domCopy.value || domCopy.innerHTML;
      domClipboard.select();
      domClipboard.setSelectionRange(0, 99999);

      // Browser-dependent clipboard execution
      if (!navigator.clipboard) {
        document.execCommand("copy");
      } else {
        navigator.clipboard.writeText(domCopy.innerHTML);
      }

      // Display a temporary checkmark response
      caller.classList.add("fa-check");
      caller.classList.remove("fa-clipboard");
      caller.style.cursor = "default";
      setTimeout(() => {
        caller.classList.add("fa-clipboard");
        caller.classList.remove("fa-check");
        caller.style.cursor = "pointer";
      }, 1000);
    }

    function openDonatePage() {
      domTxTab.click();
      if (domSimpleTXs.style.display === 'none')
        domSimpleTXsDropdown.click();
      domAddress1s.value = donationAddress;
      domValue1s.focus();
    }

    let viewPrivKey = false;
    function toggleKeyView(c) {
      viewPrivKey = !viewPrivKey;
      domGuiViewKey.innerHTML = viewPrivKey ? 'Hide Private key' : 'Show Private key';
      domPrivateTxt.style.display = domPrivateQr.style.display = viewPrivKey ? 'block' : 'none';
      // domPublicQr.style.display = !viewPrivKey ? 'block' : 'none';
      if (c != 1 && domEncryptPasswordBox.style.display === '') {
        domEncryptPasswordBox.style.display = 'none';
        domEncryptBtnTxt.innerText = 'Set Password';
      }
    }

    const keyQR = document.getElementById('keyQR');
    const keyTxt = document.getElementById('keyTxt');
    const btnTxt = document.getElementById('guiPrivKey');

    function toggleKey() {
      [keyQR, keyTxt].forEach(el => el.style.display = el.style.display === 'none' ? 'block' : 'none');
      btnTxt.textContent = keyQR.style.display === 'block' ? 'Hide Private Key' : 'Show Private Key';
    }

    function hideAllWalletOptions() {
      // Hide and Reset the Vanity address input
      domPrefix.value = PUBKEY_PREFIX;
      domPrefix.style.display = 'none';

      // Hide all "*Wallet" buttons
      domGenerateWallet.style.display = 'none';
      domImportWallet.style.display = 'none';
      domGenVanityWallet.style.display = 'none';
      domAccessWallet.style.display = 'none';
      $(".tablinks").css("display", "")

      $("body").addClass("side_nav");
      setTimeout(() => {
        initializeSideNav();
      }, 1000);
    }

    function accessOrImportWallet() {
      // Hide and Reset the Vanity address input
      domPrefix.value = PUBKEY_PREFIX;
      domPrefix.style.display = 'none';

      // Show Import button, hide access button
      domImportWallet.style.display = 'block';
      domAccessWalletBtn.style.display = 'none';

      // If we have a local wallet, display the decryption prompt
      if (hasEncryptedWallet()) {
        domPrivKey.placeholder = 'Enter your wallet password';
        domImportWalletText.innerText = 'Unlock Wallet';
        domPrivKey.focus();
        $("#importWallet .scan-qr svg").hide();
      }
    }


    function checkTransactionType(txid, userAddress) {
      let isSent = false, isReceived = false;

      // Check inputs (if userAddress is in vin, it's a sent transaction)
      $.each(txid.vin, function (index, input) {
        if (input.addresses && input.addresses.includes(userAddress)) {
          isSent = true;
        }
      });

      // Check outputs (if userAddress is in vout, it's a received transaction)
      $.each(txid.vout, function (index, output) {
        if (output.addresses && output.addresses.includes(userAddress)) {
          isReceived = true;
        } else {
          isReceived = false;
        }
      });

      if (isSent && isReceived) {
        return "Self-Transfer";  // If the sender and receiver are the same, it's a self-transfer
      } else if (isSent) {
        return "Sent";
      } else if (isReceived) {
        return "Received";
      } else {
        return "Unknown";
      }
    }


    // Global variable to store the last txids
    let lastTxids = [];

    // Function to populate the table with transaction data
    function populateTransactionTable() {
      // Make a separate request to fetch transaction data
      const request = new XMLHttpRequest();
      const apiUrl = cExplorer.url + "/api/v2/address/" + publicKeyForNetwork; // Separate API URL
      request.open('GET', apiUrl, true);
      request.onerror = networkError;
      request.onload = function () {
        const response = JSON.parse(this.response);
        const txids = response.txids.slice(0, 5); // Get a maximum of 5 txids

        // Check if the txids are the same as the last stored txids
        if (JSON.stringify(txids) === JSON.stringify(lastTxids)) {
          console.log('Same txids, skipping fetchTransactionDetails');
          return;
        }

        // Store the current txids in the global variable
        lastTxids = txids;

        // Call fetchTransactionDetails if txids are different
        if (txids.length > 0) {
          fetchTransactionDetails(txids, tableBody);
        } else {
          tableBody.innerHTML = '<tr><td colspan="3">No transactions</td></tr>';
          $(tableBody).removeClass("large-box loading");
        }
      };
      request.send();
    }


    // Function to fetch transaction details using the txids and populate the table
    function fetchTransactionDetails(txids, tableBody) {
      const moreLink = document.getElementById("more_transaction");

      if (isFetching) {
        console.log('Fetch in progress, rejecting new call');
        return; // Exit if a fetch is already in progress
      }

      isFetching = true; // Lock: set fetching in progress

      const rowsArray = new Array(txids.length); // Array to store rows in correct order
      let completedRequests = 0; // Counter to track completed requests

      txids.forEach((txid, index) => {
        const request = new XMLHttpRequest();
        const txDetailsUrl = cExplorer.url + "/api/v2/tx/" + txid; // Assuming this is the URL to get transaction details by txid
        request.open('GET', txDetailsUrl, true);
        request.onerror = networkError;
        request.onload = function () {
          const transaction = JSON.parse(this.response);

          // Extract transaction ID, amount from valueOut, confirmations, time, and blockheight
          const txid = transaction.txid;

          let totalTx = transaction.vout && transaction.vout[1] && transaction.vout[1].value !== undefined
            ? (Number(transaction.vout[1].value) + Number(transaction.fees)) / COIN
            : Number(transaction.value) / COIN;

          const amount = totalTx.toFixed(2) || "0"; // Use valueOut for the transaction amount
          let confirmations = transaction.confirmations;
          const time = transaction.blockTime; // Extract the transaction time (UNIX timestamp)
          const blockheight = transaction.blockHeight; // Extract the block height

          // If confirmations are greater than 100, display "100+"
          confirmations = confirmations > 100 ? "100+" : confirmations;

          // Convert the UNIX timestamp to a JavaScript Date object
          const date = new Date(time * 1000); // Multiply by 1000 to convert to milliseconds
          const formattedDate = date.toLocaleString(undefined, {
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            // Omit seconds by not including `second: '2-digit'`
          });
          const transactionType = checkTransactionType(transaction, publicKeyForNetwork);
          // Create the row for this txid and store it in the correct position in rowsArray
          rowsArray[index] = `
              <a class="transaction-row large-box" data-bheight="${blockheight}" href="${cExplorer.url}/tx/${txid}" target="_blank">
                <div class="details">
                  <div class="icon ${transactionType.toLowerCase()}"></div>  
                  <div class="type">
                    <span class="direction">${transactionType}</span> 
                    <div class="t-date" data-time="${time}">${formattedDate}</div>
                  </div>
                </div>
                <div class="status">
                  <div class="t-amount">${amount} Freed</div>
                  <div class="t-status" style="color:  ${confirmations ? 'green' : 'red'};">${confirmations}</div>
                </div>
              </a>
            `;

          completedRequests++;

          // Once all requests are completed, append the rows in order
          if (completedRequests === txids.length) {
            tableBody.innerHTML = rowsArray.join(''); // Append all rows at once 
            $(tableBody).removeClass("large-box loading");
            moreLink.innerHTML = `<a href="${cExplorer.url}/address/${publicKeyForNetwork}" target="_blank">More</a>`
            isFetching = false; // Unlock: set fetching to false
          }
        };
        request.send();
      });
    }




    async function guiImportWallet() {
      // If we don't have a DB wallet: prompt an import
      if (!hasEncryptedWallet()) return importWallet();

      // Prompt for decryption of the existing wallet
      const fHasWallet = await decryptWallet(domPrivKey.value);

      // If the wallet was successfully loaded, hide all options and load the dash!
      if (fHasWallet) hideAllWalletOptions();
    }

    function guiEncryptWallet() {
      // Show our inputs if we haven't already
      if (domEncryptPasswordBox.style.display === 'none') {
        // Return the display to it's class form
        domEncryptPasswordBox.style.display = '';
        domEncryptBtnTxt.innerText = 'Finish Encryption';
        if (domPrivateTxt.style.display === 'block') {
          toggleKeyView(1);
        }
      } else {
        // Fetch our inputs, ensure they're of decent entropy + match eachother
        const strPass = domEncryptPasswordFirst.value,
          strPassRetype = domEncryptPasswordSecond.value;
        if (strPass.length < MIN_PASS_LENGTH) return createAlert('warning', 'That password is a little short!<br>' +
          'Use at least <b>' + MIN_PASS_LENGTH + ' characters.</b>', 4000);
        if (strPass !== strPassRetype) return createAlert('warning', 'Your passwords don\'t match!', 2250);
        encryptWallet(strPass);
        createAlert('success', '<b>You\'re Secured! 🔐</b><br>Nice stuff, Armoured FREED!', 5500);
        $(qrModal).fadeToggle(500);
      }
    }

    function checkVanity() {
      // Loosely check if the vanity address is valid
      if (!domPrefix.value.length) return domPrefix.value = PUBKEY_PREFIX;
      if (!domPrefix.value.startsWith(PUBKEY_PREFIX)) {
        // Prefix doesnt match, splice it into the string
        domPrefix.value = PUBKEY_PREFIX + domPrefix.value.substr(1);
      }
    }

    let isVanityGenerating = false;
    const arrWorkers = [];
    let vanUiUpdater;

    function stopSearch() {
      isVanityGenerating = false;
      for (let thread of arrWorkers) {
        thread.terminate();
      }
      while (arrWorkers.length) arrWorkers.pop();
      domPrefix.disabled = false;
      domVanityUiButtonTxt.innerText = 'Create A Vanity Wallet';
      clearInterval(vanUiUpdater);
    }

    async function generateVanityWallet() {
      if (isVanityGenerating) return stopSearch();
      if (typeof (Worker) === "undefined") return alert('This browser doesn\'t support Web Workers (multi-threaded JS), unfortunately you cannot generate Vanity wallets!');
      // Generate a vanity address with the given prefix
      if (domPrefix.value.length === 0 || domPrefix.style.display === 'none') {
        // No prefix, display the intro!
        domPrefix.placeholder = 'Custom Prefix (' + PUBKEY_PREFIX + ' ...)';
        domPrefix.style.display = 'block';
        domGenKeyWarning.style.display = 'none';
        domPrivateTxt.innerHTML = "~";
        domGuiAddress.innerHTML = "~";
        domPrefix.focus();
      } else {
        // Ensure the input is base58 compatible
        for (const char of domPrefix.value) {
          if (!MAP_B58.includes(char)) return alert("The character '" + char + "' is unsupported in addresses! (Not Base58 compatible)");
        }
        // We also don't want users to be mining addresses for years... so cap the letters to four until the generator is more optimized
        if (typeof qqd === 'undefined' && domPrefix.value.length > 6) return alert("This is a long name! This would take a LONG time to find, please choose a shorter name!");
        isVanityGenerating = true;
        domPrefix.disabled = true;
        // Cache a lowercase equivilent for lower-entropy comparisons (a case-insensitive search is ALOT faster!) and strip accidental spaces
        const nInsensitivePrefix = domPrefix.value.toLowerCase().replace(/ /g, "");
        const nPrefixLen = nInsensitivePrefix.length;
        let attempts = 0;

        // Setup workers
        const nThreads = Math.max(Math.floor(window.navigator.hardwareConcurrency * 0.75), 1);
        console.log('Spawning ' + nThreads + ' vanity search threads!');
        while (arrWorkers.length < nThreads) {
          arrWorkers.push(new Worker("scripts/vanitygen_worker.js"));
          arrWorkers[arrWorkers.length - 1].onmessage = (event) => checkResult(event.data);
        }

        // GUI Updater
        domVanityUiButtonTxt.innerText = 'Stop (Searched ' + attempts.toLocaleString('en-GB') + ' keys)';
        vanUiUpdater = setInterval(() => {
          domVanityUiButtonTxt.innerText = 'Stop (Searched ' + attempts.toLocaleString('en-GB') + ' keys)';
        }, 200);

        function checkResult(data) {
          attempts++;
          if (data.pub.substr(0, nPrefixLen).toLowerCase() == nInsensitivePrefix) {
            importWallet(data.priv, true);
            stopSearch();
            domGuiBalance.innerHTML = "0";
            domGuiBalanceBox.style.fontSize = "x-large";
            return console.log("VANITY: Found an address after " + attempts + " attempts!");
          }
        }
      }
    }

    function toggleDropDown(id) {
      const domID = document.getElementById(id);
      domID.style.display = domID.style.display === 'block' ? 'none' : 'block';
    }



    // Coin Control response formats
    function ccError(msg = '') { return { success: false, msg } };
    function ccSuccess(data) { return { success: true, ...data } };

    function chooseUTXOs(cTx, nTotalSatsRequired = 0, nMinInputSize = 0, fColdOnly = false) {
      console.log("Constructing TX of value: " + (nTotalSatsRequired / COIN) + " FREED");

      const arrUTXOs = cachedUTXOs;
      const cCoinControl = { nValue: 0, nChange: 0, arrSelectedUTXOs: [] };

      for (const cUTXO of arrUTXOs) {
        if (cCoinControl.nValue >= nTotalSatsRequired) {
          console.log("Coin Control: TX Constructed! Selected " + cCoinControl.arrSelectedUTXOs.length +
            " input(s) (" + (cCoinControl.nValue / COIN) + " FREED)");
          break;
        }
        if (cUTXO.sats < nMinInputSize) continue;

        cCoinControl.arrSelectedUTXOs.push(cUTXO);
        cCoinControl.nValue += cUTXO.sats;
        console.log("Coin Control: Selected input " + cUTXO.id.substr(0, 6) + "(" + cUTXO.vout + ")... " +
          "(Added " + (cUTXO.sats / COIN) + " FREED - Total: " + (cCoinControl.nValue / COIN) + ")");
      }

      if (cCoinControl.nValue < nTotalSatsRequired)
        return ccError("Balance is too small! (Missing " +
          (nTotalSatsRequired - cCoinControl.nValue).toLocaleString('en-gb') + " sats)");

      for (const cUTXO of cCoinControl.arrSelectedUTXOs)
        cTx.addinput(cUTXO.id, cUTXO.vout, cUTXO.script);

      // FIX: Correct change calculation
      cCoinControl.nChange = cCoinControl.nValue - nTotalSatsRequired;

      return ccSuccess(cCoinControl);
    }

    function formatNumber(value, withBurn = false) {
      // Remove invalid characters
      value = value.replace(/[^0-9.]/g, '');
      // Prevent multiple decimal points
      value = value.replace(/(\..*?)\..*/g, '$1');
      // Automatically add a decimal if the first character is '0' and there's more input
      if (value.startsWith('0') && value.length > 1 && !value.startsWith('0.')) {
        value = '0.' + value.substring(1).replace('.', ''); // Remove existing decimals after auto-add
      }

      if (withBurn) {
        let num = parseFloat(value) || 0;
        let burnAmount = num * BURN_PERCENT;
        $("#toburn").text(parseFloat(burnAmount.toFixed(8)) + " FREED will be burned.");
        if (guiBal) {
          let totalAndBurn = Number(guiBal) - (num + burnAmount);
          $("#total_val").text("Total Amount: " + parseFloat(totalAndBurn.toFixed(8)));
        }
      }
      return value;
    }

    function addZeroIfDotEnd(input) {
      if (input.value.endsWith('.') && input.value.length > 1) {
        input.value += '0';
      }
    }


    function swap(params) {
      createAlert('warning', 'Swap is temporarily unavailable. Please check back later!', 2500);
    }

    function createTxGUI(call) {
      if (!hasWalletUnlocked(true) && call != 'modal') return;

      // Clear the inputs on 'Continue'
      if (domGenIt.innerHTML === 'Continue' || call === 'modal') {
        domSimpleTXsTitleSpan.innerHTML = "Create a";
        domGenIt.innerHTML = 'Send Transaction';
        domTxOutput.innerHTML = '';
        domHumanReadable.innerHTML = "";
        domValue1s.value = "";
        domAddress1s.value = "";
        domReqDesc.value = '';
        domReqDisplay.style.display = 'none';
        return;
      }

      // Sanity check the address
      const address = domAddress1s.value.trim();
      if (address.length !== 34) return createAlert('warning', `<b>Invalid FREED address!</b><br>Bad length (${address.length})`, 2500);
      if (!address.startsWith(PUBKEY_PREFIX)) return createAlert('warning', `<b>Invalid FREED address!</b><br>Bad prefix ${address[0]} (Should start with ${PUBKEY_PREFIX})`, 3500);

      // Sanity check the amount
      let nValue = Math.round(Number(domValue1s.value.trim()) * COIN);
      if (nValue <= 0 || isNaN(nValue)) return createAlert('warning', `<b>Invalid amount!</b><br>You can't send 'nothing'!`, 2500);
      if (!Number.isSafeInteger(nValue)) return createAlert('warning', `<b>Invalid amount!</b><br>8 decimal limit exceeded`, 2500);

      // Construct TX and fetch standard inputs
      const nBalance = getBalance();
      const cTx = bitjs.transaction();

      // Calculate burn (on top of send amount)
      const burnAmount = Math.floor(nValue * 0.05);

      // Total required = value + burn + fee (fee estimated later)
      const cCoinControl = chooseUTXOs(cTx, nValue + burnAmount, 0, false);
      if (!cCoinControl.success) return alert(cCoinControl.msg);

      // Compute fee
      const nFee = getFee(cTx.serialize().length);

      // Compute change (balance - everything)
      let nChange = cCoinControl.nValue - (nValue + burnAmount + nFee);
      if (nChange < 0) {
        return createAlert('warning', `<b>Insufficient balance!</b><br>You need more to cover amount + 5% burn + fee.`, 3500);
      }

      // Change output
      if (nChange > 0) {
        cTx.addoutput(publicKeyForNetwork, nChange / COIN);
      }

      // Primary output (receiver gets full requested amount)
      cTx.addoutput(address, nValue / COIN);

      // Burn output (only if BURN_WALLET is set)
      if (BURN_WALLET && burnAmount > 0) {
        cTx.addoutput(BURN_WALLET, burnAmount / COIN);
      }

      // Debug info
      if (debug) {
        domHumanReadable.innerHTML = `
            Balance: ${nBalance / COIN}<br>
            Fee: ${nFee / COIN}<br>
            To: ${address}<br>
            Sent: ${nValue / COIN}<br>
            Burn: ${burnAmount / COIN}${nChange > 0 ? `<br>Change Address: ${publicKeyForNetwork}<br>Change: ${nChange / COIN}` : ''}
        `;
      }

      // Sign and broadcast
      sendTransaction(cTx.sign(privateKeyForTransactions, 1));
      domGenIt.innerHTML = "Continue";
    }


    function createRawTransaction() {
      // Prepare a TX
      const cTx = bitjs.transaction();
      const txid = document.getElementById("prevTrxHash").value;
      const index = document.getElementById("index").value;
      const script = document.getElementById("script").value;

      // Primary input
      cTx.addinput(txid, index, script);

      // Primary output
      const strAddress = document.getElementById("address1").value;
      const nValue = document.getElementById("value1").value;
      cTx.addoutput(strAddress, nValue);

      // Change output
      const strChange = document.getElementById("address2").value;
      const nChangeValue = document.getElementById("value2").value;
      cTx.addoutput(strChange, nChangeValue);

      // Sign via WIF key
      const wif = document.getElementById("wif").value;
      document.getElementById("rawTrx").value = cTx.sign(wif, 1); //SIGHASH_ALL DEFAULT 1
    }

    function checkMediaQuery(maxWidth) {
      return window.matchMedia(`(max-width: ${maxWidth})`).matches;
    }

    let contentWrap;
    let sideNav;

    function initializeSideNav() {
      // Make sure elements exist before binding events
      contentWrap = $(".side_nav #content-wrap");
      sideNav = $(".side_nav");

      // Only proceed if both elements are found
      if (contentWrap.length && sideNav.length) {
        bindSwipeEvents();
      }

      if (!checkMediaQuery("650px")) return;
      setTimeout(
        () => {
          toggleSideNav(true);
          setTimeout(() => {
            toggleSideNav(false);
          }, 2000); // 2 seconds later
        }, 3000
      );
    }

    function bindSwipeEvents() {
      if (!checkMediaQuery("650px")) return;
      let touchStartX = 0;
      let touchEndX = 0;
      let touchStartY = 0;
      let touchEndY = 0;
      let isSwiping = false;

      contentWrap.on("touchstart", function (e) {
        touchStartX = e.originalEvent.touches[0].clientX;
        touchStartY = e.originalEvent.touches[0].clientY;
        isSwiping = false; // Reset swipe detection

        // Prevent swipe-back navigation if swiping from the left edge
        if (touchStartX < 20) {
          e.preventDefault();
        }
      });

      contentWrap.on("touchmove", function (e) {
        touchEndX = e.originalEvent.touches[0].clientX;
        touchEndY = e.originalEvent.touches[0].clientY;

        let deltaX = touchEndX - touchStartX;
        let deltaY = touchEndY - touchStartY;

        // Only consider horizontal swipes and ignore small movements
        if (Math.abs(deltaX) > 10 && Math.abs(deltaX) > Math.abs(deltaY)) {
          e.preventDefault();
          isSwiping = true;
        }
      });

      contentWrap.on("touchend", function () {
        if (!isSwiping) return; // Prevent accidental tap from triggering swipe

        let swipeDistance = touchEndX - touchStartX;
        if (swipeDistance > 50) {
          toggleSideNav(true); // Swipe Right (Show)
        } else if (swipeDistance < -50) {
          toggleSideNav(false); // Swipe Left (Hide)
        }
      });
    }


    function toggleSideNav(open) {
      if (!checkMediaQuery("650px")) return;

      $("body").toggleClass("swipe_right");
      if (open) {
        // Show menu (Swipe Right)
        contentWrap.css({
          "left": "0",
          "opacity": "0.7"
        });
        contentWrap.find(".container").css("pointer-events", "none");
        sideNav.css("overflow", "hidden");
        $("body").addClass("swipe_right");
      } else {
        // Hide menu (Swipe Left)
        contentWrap.css({
          "left": "",
          "opacity": ""
        });
        contentWrap.find(".container").css("pointer-events", "");
        sideNav.css("overflow", "");
        $("body").removeClass("swipe_right");
      }
    }



    function toggleNavigation(s) {
      $("nav .navbar-collapse").slideToggle(500);
      $("#navbarToggler").toggleClass("collapsed collapse");
    }
    $("#navbarToggler").click(toggleNavigation);

    function openModal(evt, modalName, close) {
      $(qrModal).fadeToggle(500);
      $('#' + modalName).fadeToggle(500);
      if (close === 'T' && !$('#simpleTransactions').is(':visible')) {
        setTimeout(function () {
          createTxGUI('modal');
          toggleDropDown("simpleTransactions");
        }, 1000);
      }
    }
    function hideModal(evt, modalName, action) {
      $(qrModal).fadeToggle(500);
      $('#' + modalName).toggleClass(action);
    }

    function openTab(evt, tabName) {
      // Hide all screens and deactivate link highlights
      for (const domScreen of arrDomScreens) domScreen.style.display = "none";
      for (const domLink of arrDomScreenLinks) domLink.classList.remove("active");

      // Show and activate the given screen
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.classList.add("active");
      // Close the navbar if it's not already closed 
      if (!!contentWrap) {
        toggleSideNav(false);
      }

      if (!domNavbarToggler.className.includes("collapsed"))
        toggleNavigation();
    }
    domStart.click();

    function refreshChainData() {
      // If in offline mode: don't sync ANY data or connect to the internet
      if (!networkEnabled) return console.warn("Offline mode active: For your security, the wallet will avoid ALL internet requests.");
      if (!publicKeyForNetwork) return;

      // Fetch block count + UTXOs
      getBlockCount();
    }

    // A safety mechanism enabled if the user attempts to leave without encrypting/saving their keys
    const beforeUnloadListener = (evt) => {
      evt.preventDefault();
      createAlert("warning", "<b>Save your wallet!</b><br>Dashboard ➜ Set Password", 10000);
      // Most browsers ignore this nowadays, but still, keep it 'just incase'
      return evt.returnValue = "Please ENCRYPT and/or BACKUP your keys before leaving, or you may lose them!";
    };

    window.onload = (() => {

      // Configure payment processor
      if (requestTo && requestAmount) {
        // Open 'Create Transaction' menu
        domTxTab.click();
        if (domSimpleTXs.style.display === 'none')
          domSimpleTXsDropdown.click();

        // Pre-fill inputs
        domAddress1s.value = requestTo;
        domValue1s.value = requestAmount;

        // Payment request 'desc' is optional
        if (urlParams.has('desc')) {
          domReqDisplay.style.display = 'block';
          domReqDesc.value = urlParams.get('desc');
        } else {
          domReqDisplay.style.display = 'none';
        }
      }
    });

    setInterval(refreshChainData, 15000);
    domPrefix.value = PUBKEY_PREFIX;
  </script>

</body>
<!-- Load complex backend-level components last -->
<script type="text/javascript" src="scripts/libs/aes-gcm.js"></script>
<script type="text/javascript" src="scripts/libs/crypto-min.js"></script>
<script type="text/javascript" src="scripts/libs/crypto-sha256.js"></script>
<script type="text/javascript" src="scripts/libs/crypto-sha256-hmac.js"></script>
<script type="text/javascript" src="scripts/libs/ripemd160.js"></script>
<script type="text/javascript" src="scripts/libs/jsbn.js"></script>
<script type="text/javascript" src="scripts/libs/ellipticcurve.js"></script>
<script type="text/javascript" src="scripts/libs/script.js"></script>
<script type="text/javascript" src="scripts/libs/qrcode.js"></script>
<script type="text/javascript" src="scripts/libs/sha256.js"></script>
<script type="text/javascript" src="scripts/libs/bn.js"></script>
<script type="text/javascript" src="scripts/libs/secp256k1.js"></script>
<script type="text/javascript" src="scripts/libs/noble-secp256k1.js"></script>
<script type="text/javascript" src="scripts/bitTrx.js"></script>
<script>
  // Throw the Secp256k1 lib as a global after import
  const nSecp256k1 = nobleSecp256k1.default;
</script>

</html>